Index: trunk/src/VBox/Additions/linux/sharedfolders/dirops.c
===================================================================
--- trunk/src/VBox/Additions/linux/sharedfolders/dirops.c	(revision 47588)
+++ trunk/src/VBox/Additions/linux/sharedfolders/dirops.c	(revision 48529)
@@ -283,8 +283,11 @@
 
 #if LINUX_VERSION_CODE >= KERNEL_VERSION(3, 11, 0)
-        err = dir_emit(ctx, d_name, strlen(d_name), fake_ino, DT_UNKNOWN);
+        if (!dir_emit(ctx, d_name, strlen(d_name), fake_ino, DT_UNKNOWN))
+        {
+            LogFunc(("dir_emit failed\n"));
+            return 0;
+        }
 #else
         err = filldir(opaque, d_name, strlen(d_name), dir->f_pos, fake_ino, DT_UNKNOWN);
-#endif
         if (err)
         {
@@ -294,4 +297,5 @@
             return 0;
         }
+#endif
 
         dir->f_pos += 1;
